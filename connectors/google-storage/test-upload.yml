workflow:
  name: "google-storage-test-upload"
  title: "Google Storage Test Upload"
  description: "Workflow to test the Google Storage upload (supports images and audio)."
  context-variables:
    debugger:
      enabled: true
    google-storage:
      api_key: "$MACHINA_CONTEXT_VARIABLE_GOOGLE_STORAGE_API_KEY"
      bucket_name: "$MACHINA_CONTEXT_VARIABLE_GOOGLE_STORAGE_BUCKET_NAME"
    openai:
      api_key: "$TEMP_CONTEXT_VARIABLE_SDK_OPENAI_API_KEY"
  inputs:
    file_path: "$.get('file_path') or $.get('image_path')"
    filename: "$.get('filename')"
  outputs:
    data: "$.get('data')"
    url: "$.get('data.url')"
    path: "$.get('data.path')"
    message: "$.get('data.message')"
    workflow-status: "$.get('workflow-status', 'skipped')"
  tasks:

    # 1 test-upload
    - type: "connector"
      name: "test-upload"
      description: "Uploads a file to Google Cloud Storage."
      connector:
        name: "google-storage"
        command: "invoke_upload"
      inputs:
        file_path: "$.get('file_path')"
        filename: "$.get('filename')"
      outputs:
        data: "$"
        workflow-status: "'executed'"
