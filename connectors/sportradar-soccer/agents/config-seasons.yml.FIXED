agent:
  name: sportradar-soccer-config-seasons
  title: Sportradar - Soccer Config Seasons
  description: Agent to config seasons for coverage tools (with cooldown fix)
  context:
    config-frequency: 10
    status: inactive
    cooldown-minutes: 120  # Execute only once every 2 hours
  workflows:

    # COOLDOWN CHECK - Execute first to prevent loop
    - name: sportradar-soccer-cooldown-check
      description: Check if enough time has passed since last execution
      outputs:
        should-execute: $.get('should-execute', False)
        last-execution-time: $.get('last-execution-time', '')
        time-since-last-run: $.get('time-since-last-run', 0)

    # sportradar-soccer-config-seasons-workflow
    - name: sportradar-soccer-config-seasons-workflow
      description: config-seasons-workflow
      condition: $.get('should-execute', False) == True
      outputs:
        competition-ids: $.get('competition-ids')
        current-seasons: $.get('current-seasons')
        current-seasons-id: $.get('current-seasons-id')

    # sportradar-soccer-sync-season-schedules
    - name: sportradar-soccer-sync-season-schedules
      description: sync-season-schedules
      condition: $.get('should-execute', False) == True
      inputs:
        season_ids: $.get('current-seasons-id')
      outputs:
        sync-season-schedules-status: $.get('workflow-status', False)

    # sportradar-soccer-sync-schedules
    - name: sportradar-soccer-sync-schedules
      description: sync-schedules
      condition: $.get('should-execute', False) == True
      foreach:
        name: current-season-id
        expr: $
        value: $.get('current-seasons-id')
      inputs:
        season_id: $.get('current-season-id')
      outputs:
        sync-schedules-status: $.get('workflow-status', False)

    # sportradar-soccer-sync-competitors
    - name: sportradar-soccer-sync-competitors
      description: sync-competitors
      condition: $.get('should-execute', False) == True
      foreach:
        name: current-season-id
        expr: $
        value: $.get('current-seasons-id')
      inputs:
        season_id: $.get('current-season-id')
      outputs:
        sync-competitors-status: $.get('workflow-status', False)

    # sportradar-soccer-sync-standings
    - name: sportradar-soccer-sync-standings
      description: sync-standings
      condition: $.get('should-execute', False) == True
      foreach:
        name: current-season-id
        expr: $
        value: $.get('current-seasons-id')
      inputs:
        season_id: $.get('current-season-id')
      outputs:
        sync-standings-status: $.get('workflow-status', False)

    # sportradar-soccer-sync-season-leaders
    - name: sportradar-soccer-sync-season-leaders
      description: sync-season-leaders
      condition: $.get('should-execute', False) == True
      foreach:
        name: current-season-id
        expr: $
        value: $.get('current-seasons-id')
      inputs:
        season_id: $.get('current-season-id')
      outputs:
        sync-season-leaders-status: $.get('workflow-status', False)

    # UPDATE TIMESTAMP - Execute last to record completion
    - name: sportradar-soccer-update-timestamp
      description: Update last execution timestamp
      condition: $.get('should-execute', False) == True
      outputs:
        timestamp-updated: $.get('timestamp-updated', False)
