workflow:
  name: sportradar-soccer-update-timestamp
  title: Sportradar Soccer - Update Execution Timestamp
  description: Update the last execution timestamp to prevent re-execution within cooldown period
  outputs:
    timestamp-updated: $.get('timestamp-updated', False)
    workflow-status: "'executed'"
  tasks:

    # Update or create execution lock document with current timestamp
    - type: document
      name: update-execution-timestamp
      description: Save current timestamp to prevent immediate re-execution
      config:
        action: update
        embed-vector: false
        force-update: true
      documents:
        sportradar-soccer-config-seasons-execution-lock: |
          {
            "name": "sportradar-soccer-config-seasons-execution-lock",
            "title": "Sportradar Soccer Config Seasons - Execution Lock",
            "description": "Stores last execution timestamp to prevent infinite loop",
            "last_execution_time": __import__('datetime').datetime.utcnow().isoformat() + "Z",
            "cooldown_minutes": 120,
            "updated_at": __import__('datetime').datetime.utcnow().isoformat() + "Z"
          }
      outputs:
        timestamp-updated: True
