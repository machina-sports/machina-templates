workflow:
  name: "api-football-test-credentials"
  title: "API Football - Test Credentials"
  description: "Simple workflow to test API Football credentials."
  context-variables:
    debugger:
      enabled: true
    api-football:
      x-apisports-key: $TEMP_CONTEXT_VARIABLE_API_FOOTBALL_API_KEY
  outputs:
    result: "$.get('test_result', {})"
    workflow-status: "$.get('workflow-status', 'skipped')"
  tasks:

    - type: connector
      name: api-football-test-credentials-task
      description: Test credentials by fetching leagues list.
      connector:
        name: api-football
        command: get-leagues
      inputs:
        current: "'true'"
      outputs:
        test_result: |
          {
            'status': 'success' if $.get('response') else 'error',
            'leagues_count': len($.get('response', [])),
            'sample': [
              {'id': l.get('league', {}).get('id'), 'name': l.get('league', {}).get('name'), 'country': l.get('country', {}).get('name')}
              for l in $.get('response', [])[:5]
            ] if $.get('response') else []
          }
        workflow-status: "'executed'"
