workflow:
  name: "machina-football-data-test-credentials"
  title: "Machina Football Data - Test Connectivity"
  description: "Test Machina Football Data connector by verifying ESPN connectivity and optional football-data.org API key."
  context-variables:
    debugger:
      enabled: true
    machina-football-data:
      api_key: $TEMP_CONTEXT_VARIABLE_FOOTBALL_DATA_API_KEY
  outputs:
    result: "$.get('test_result', {})"
    workflow-status: "$.get('workflow-status', 'skipped')"
  tasks:

    - type: connector
      name: machina-football-data-test-espn
      description: Test ESPN connectivity by fetching competitions list (no API key needed).
      connector:
        name: machina-football-data
        command: get_competitions
      inputs: {}
      outputs:
        test_result: |
          {
            'status': 'success' if $.get('competitions') else 'error',
            'source': 'espn' if not $.get('api_key') else 'football-data.org',
            'competitions_count': len($.get('competitions', [])),
            'sample': $.get('competitions', [])[:3] if $.get('competitions') else [],
            'fd_key_configured': bool($.get('api_key', ''))
          }
        workflow-status: "'executed'"
