workflow:
  name: "wordpress-push-draft-test"
  title: "WordPress Push Draft Test"
  description: "Push a sample article with images as a draft to WordPress."
  context-variables:
    debugger:
      enabled: true
    wordpress:
      site_url: "$TEMP_CONTEXT_VARIABLE_WORDPRESS_SITE_URL"
      username: "$TEMP_CONTEXT_VARIABLE_WORDPRESS_USERNAME"
      application_password: "$TEMP_CONTEXT_VARIABLE_WORDPRESS_APP_PASSWORD"
  inputs:
    title: "$.get('title', 'Sample Draft From Machina')"
    content_html: "$.get('content_html', '<p>Hello from Machina!</p>')"
    excerpt: "$.get('excerpt', 'Short summary of the sample post')"
    image_url: "$.get('image_url')"
  outputs:
    post_id: "$['post'].get('id')"
    draft_url: "$['post'].get('link')"
    workflow-status: "$['post'].get('id') is None and 'skipped' or 'executed'"
  tasks:
    - type: "connector"
      name: "create draft post"
      description: "Create a draft post in WordPress, optionally uploading one image."
      connector:
        name: "wordpress"
        command: "create_draft_post"
      inputs:
        title: "$['title']"
        content_html: "$['content_html']"
        excerpt: "$['excerpt']"
        images: "[$['image_url'] is not None and {'url': $['image_url'], 'title': 'Sample Image'} or None]"
      outputs:
        post: "$['post']"
        uploaded_media: "$['uploaded_media']"


