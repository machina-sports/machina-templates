workflow:
  name: "grok-test-chat-completion"
  title: "Grok Test Chat Completion"
  description: "Workflow to test the xAI Grok API chat completion functionality."
  context-variables:
    debugger:
      enabled: true
    grok:
      api_key: "$MACHINA_CONTEXT_VARIABLE_GROK_API_KEY"
  inputs:
    user_message: "$.get('user_message', 'Testing. Just say hi and hello world and nothing else.')"
    model: "$.get('model', 'grok-4-latest')"
    temperature: "$.get('temperature', 0)"
    max_tokens: "$.get('max_tokens', 100)"
  outputs:
    data: "$.get('data')"
    workflow-status: "'executed'"
  tasks:

    # 1 test-chat-completion
    - type: "connector"
      name: "test-chat-completion"
      description: "Test the xAI Grok API chat completion."
      connector:
        name: "grok"
        command: "post-chat/completions"
      inputs:
        body: |
          {
            "messages": [
              {
                "role": "user",
                "content": $.get('user_message')
              }
            ],
            "model": $.get('model'),
            "stream": False,
            "temperature": $.get('temperature'),
            "max_tokens": $.get('max_tokens')
          }
      outputs:
        data: "$"
        workflow-status: "'executed'"
