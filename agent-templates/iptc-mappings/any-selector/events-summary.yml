mappings:

  # iptc-events-summary
  - type: mapping
    name: iptc-events-summary
    title: "IPTC | Events Summary"
    description: "Selects multiple events summary equivalent to the search query"
    outputs:
      events_summary: |
        [
          " | ".join([
            event.get('name', 'N/A'),
            event.get('schema:sportName', 'N/A'),
            event.get('schema:startDate', 'N/A'),
            event.get('sport:competition', {}).get('name', 'N/A'),
            event.get('sport:competition', {}).get('sport:season', {}).get('name', 'N/A'),
            f"{next((c.get('name') for c in event.get('sport:competitors', []) if c.get('sport:qualifier') == 'home'), 'N/A')} vs {next((c.get('name') for c in event.get('sport:competitors', []) if c.get('sport:qualifier') == 'away'), 'N/A')}",
            event.get('sport:status', 'N/A'),
            f"Score: {event.get('sport:score', {}).get('sport:homeScore')} - {event.get('sport:score', {}).get('sport:awayScore')}" if event.get('sport:score', {}).get('sport:homeScore') is not None else 'No score',
            event.get('sport:venue', {}).get('name', 'N/A'),
            event.get('sport:venue', {}).get('schema:addressLocality', 'N/A')
          ])
          for event in $.get('events', [])
        ]
