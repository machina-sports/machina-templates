agent:
  name: soccer-kalshi-analyst
  title: Soccer Kalshi Analyst Agent
  description: |
    An advanced soccer prediction agent that generates high-fidelity match forecasts 
    using a multi-stage analytical pipeline
  context:
    config-frequency: 10
    status: "inactive"
  context-agent:
    fixture_id: "$.get('fixture_id')"
  workflows:
  
    # 1. Consumer: Find upcoming fixtures needing analysis
    - name: soccer-kalshi-analysis-consumer
      description: Identify upcoming soccer fixtures eligible for AI forecasting
      inputs:
        fixture_id: $.get('fixture_id')
      outputs:
        analysis_fixture_id: $.get('fixture_id')
        analysis_fixture_exists: $.get('workflow-status', 'skipped') == 'executed'

    # 2. Executor: Run the full forecasting and market integration pipeline
    - name: soccer-forecast-match
      description: |
        Execute the complete forecast pipeline:
        - Load event data and team statistics
        - Generate and execute news search queries
        - Extract structured evidence from news
        - Run statistical, evidence, matchup, and risk analyses
        - Parameterize and run Monte Carlo simulation
        - Generate final calibrated probabilities
        - Identify Kalshi market edges (if markets available)
      condition: $.get('analysis_fixture_exists') is True
      inputs:
        fixture_id: $.get('analysis_fixture_id')
      outputs:
        forecast_document_id: $.get('prediction_document_id')
        forecast_executor_status: $.get('workflow-status', 'skipped') == 'executed'

    # 3. Update: Finalize version control and status
    - name: soccer-kalshi-analysis-update
      description: Finalize analysis status, update document versioning, and mark fixture as analyzed
      condition: $.get('analysis_fixture_exists') is True
      inputs:
        fixture_id: $.get('analysis_fixture_id')
        is_finished: $.get('forecast_executor_status') == 'executed'
      outputs:
        analysis_update_status: $.get('workflow-status', 'skipped') == 'executed'
